---
import '../styles/global.css';
import Navigation from '../components/Navigation.astro';
import Footer from '../components/Footer.astro';
import Popup from '../components/Popup.astro';

interface Props {
  title: string;
  description?: string;
  lang?: 'en' | 'fr';
  showPopup?: boolean;
}

const {
  title,
  description = "Forest International School Paris - A bilingual school nurturing young minds through nature-based learning",
  lang = 'en',
  showPopup = true
} = Astro.props;

const altLang = lang === 'en' ? 'fr' : 'en';
const currentPath = Astro.url.pathname;
const altPath = currentPath.replace(`/${lang}`, `/${altLang}`);

// Popup configuration - Edit these values to change the popup content
const popupConfig = {
  en: {
    enabled: true,
    title: "Open Day - Book Your Visit!",
    message: "Discover our unique nature-based approach to bilingual education. Meet our teachers, tour our beautiful campus next to the Marly Forest, and see why families choose FISP.",
    buttonText: "Book a Visit",
    buttonLink: "/en/contact",
    secondaryButtonText: "Learn More",
    secondaryButtonLink: "/en/admissions",
    badge: "Limited Spots Available",
    image: "/images/campus.jpg"
  },
  fr: {
    enabled: true,
    title: "Journee Portes Ouvertes",
    message: "Decouvrez notre approche unique de l'education bilingue basee sur la nature. Rencontrez nos enseignants, visitez notre magnifique campus a cote de la Foret de Marly.",
    buttonText: "Reserver une Visite",
    buttonLink: "/fr/contact",
    secondaryButtonText: "En Savoir Plus",
    secondaryButtonLink: "/fr/admissions",
    badge: "Places Limitees",
    image: "/images/campus.jpg"
  }
};

const popup = popupConfig[lang];
---

<!DOCTYPE html>
<html lang={lang}>
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="description" content={description} />
    <link rel="icon" type="image/svg+xml" href="/favicon.svg" />
    <link rel="alternate" hreflang={altLang} href={altPath} />
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Playfair+Display:wght@400;500;600;700&display=swap" rel="stylesheet">
    <title>{title} | Forest International School Paris</title>
  </head>
  <body class="bg-[#faf8f5] text-gray-800 min-h-screen flex flex-col">
    <Navigation lang={lang} />
    <main class="flex-grow">
      <slot />
    </main>
    <Footer lang={lang} />

    <!-- Popup Component -->
    {showPopup && (
      <Popup
        enabled={popup.enabled}
        title={popup.title}
        message={popup.message}
        buttonText={popup.buttonText}
        buttonLink={popup.buttonLink}
        secondaryButtonText={popup.secondaryButtonText}
        secondaryButtonLink={popup.secondaryButtonLink}
        badge={popup.badge}
        image={popup.image}
        lang={lang}
      />
    )}

    <!-- Floating Contact Button -->
    <div class="fixed bottom-6 right-6 z-50 flex flex-col gap-3">
      <!-- WhatsApp / Phone Button -->
      <a
        href="tel:+33139168735"
        class="group w-14 h-14 bg-[#2d5a3d] hover:bg-[#1e3d29] rounded-full flex items-center justify-center shadow-lg hover:shadow-xl transition-all hover:scale-110"
        aria-label={lang === 'fr' ? 'Appelez-nous' : 'Call us'}
      >
        <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z"/>
        </svg>
      </a>

      <!-- Email Button -->
      <a
        href="mailto:infos@forest-international-school.com"
        class="group w-14 h-14 bg-[#c9a962] hover:bg-[#b8984f] rounded-full flex items-center justify-center shadow-lg hover:shadow-xl transition-all hover:scale-110"
        aria-label={lang === 'fr' ? 'Envoyez-nous un email' : 'Email us'}
      >
        <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"/>
        </svg>
      </a>
    </div>
  </body>
</html>
